# Caterpillar C API
#
# All types and API functions are described in this file. They are used to
# generate the Caterpillar C API headers and to build the documentation.
#
# modified format from sphinx documentation
# see https://github.com/python/cpython/blob/main/Doc/data/refcounts.dat
#
# There are currently four different types of statements:
#
#   type:INDEX:STRUCT_NAME:TYPEDEF_NAME:CAPI_TYPE_NAME
#       Defines a C API type for a C structure. The index is optional and
#       the CAPI_TYPE_NAME will add an extra macro to the header file.
#
#   obj:INDEX:NAME:TYPE
#       Defines a C API object.
#
#   func:INDEX:NAME:RETURN_TYPE:REFCOUNT
#       Defines a C API function. The function must be present within the
#       source set of this file.
#
#   src:FILE:IGNORE
#       Defines the source file (relative to this file) that contains the
#       function definitions. IGNORE indicates this file won't be used to
#       generate the module file.

src:ccaterpillar/arch.c
src:ccaterpillar/context.c
src:ccaterpillar/atom.c
src:ccaterpillar/option.c
src:ccaterpillar/lengthinfo.c

# First index is reserved for the global module reference
obj:0:CpModule:PyModuleDef

type:-:_modulestate:_modulestate:-

# CpArch API
type:1:_archobj:CpArchObject:c_Arch
func:-:CpArch_New:PyObject*:+1
func:-:CpArch_GetName:PyObject*:+1
func:-:CpArch_GetPtrSize:int:null

# CpEndian API
type:2:_endianobj:CpEndianObject:c_Endian
func:-:CpEndian_GetName:PyObject*:+1
func:-:CpEndian_GetId:char:null
func:3:CpEndian_IsLittleEndian:int:null

# CpOption API
type:4:_optionobj:CpOptionObject:c_Option
func:-:CpOption_New:PyObject*:+1
func:-:CpOption_SetValue:int:null
func:-:CpOption_GetValue:PyObject*:+1
func:-:CpOption_GetName:PyObject*:+1

# CpContext API
type:5:_contextobj:CpContextObject:c_Context
func:6:CpContext_GenericGetAttr:PyObject*:+1
func:7:CpContext_GenericGetAttrString:PyObject*:+1
func:8:CpContext_GetRoot:PyObject*:+1
func:-:CpContext_New:PyObject*:+1
func:-:CpContext_GetDict:PyObject*:+1
func:9:CpContext_GenericSetAttr:int:null
func:10:CpContext_GenericSetAttrString:int:null

# CpAtom API
type:11:_atomobj:CpAtomObject:Atom

# Length info
type:20:_lengthinfoobj:CpLengthInfoObject:LengthInfo
func:-:CpLengthInfo_New:PyObject*:+1
func:-:CpLengthInfo_Length:int:null
func:-:CpLengthInfo_IsGreedy:int:null
func:-:CpLengthInfo_LengthAsLong:PyObject*:+1
func:-:CpLengthInfo_SetLengthFromLong:int:null
func:-:CpLengthInfo_SetLength:int:null
func:-:CpLengthInfo_SetGreedy:void:null