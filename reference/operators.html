
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3. Operators &#8212; Caterpillar 1.0.0-b1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=ccbef229"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reference/operators';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Library" href="../library/index.html" />
    <link rel="prev" title="2. Data Model" href="datamodel.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>


<script>
document.write(`<div class="bd-header-announcement"></div>`);
fetch("https://raw.githubusercontent.com/MatrixEditor/caterpillar/master/docs/_templates/announcement.html")
  .then(res => {return res.text();})
  .then(data => {
    div = document.querySelector(".bd-header-announcement");
    div.classList.add(...["bd-header-announcement", "container-fluid"]);
    div.innerHTML = `<div class="bd-header-announcement__content">${data}</div>`;
  })
  .catch(error => {
    console.log("[PST]: Failed to load announcement at: https://raw.githubusercontent.com/MatrixEditor/caterpillar/master/docs/_templates/announcement.html");
  });
</script>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Caterpillar</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../installing/index.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../tutorial/index.html">
                        Tutorial
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../library/index.html">
                        Library
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../development/index.html">
                        Development
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/MatrixEditor/caterpillar" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../installing/index.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../tutorial/index.html">
                        Tutorial
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../library/index.html">
                        Library
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../development/index.html">
                        Development
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/MatrixEditor/caterpillar" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="datamodel.html">2. Data Model</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">3. Operators</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Reference</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="operators">
<span id="id1"></span><h1><span class="section-number">3. </span>Operators<a class="headerlink" href="#operators" title="Link to this heading">#</a></h1>
<p><em>TODO: describe all supported operators</em></p>
<p><em>Caterpillar</em> supports various operators for <a class="reference internal" href="../library/model.html#caterpillar.model.Sequence" title="caterpillar.model.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>,
<a class="reference internal" href="../library/model.html#caterpillar.model.Struct" title="caterpillar.model.Struct"><code class="xref py py-class docutils literal notranslate"><span class="pre">Struct</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code>, and custom struct implementations
<a class="footnote-reference brackets" href="#id3" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. This section provides an overview of the operators that can be used with
structs, including special context operations.</p>
<section id="struct-operators">
<h2><span class="section-number">3.1. </span>Struct operators<a class="headerlink" href="#struct-operators" title="Link to this heading">#</a></h2>
<p>All functions described below return a new <code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code> instance if not already
called on a field object.</p>
<dl class="py function">
<dt class="sig sig-object py" id="struct.__getitem__">
<span class="sig-prename descclassname"><span class="pre">struct.</span></span><span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#struct.__getitem__" title="Link to this definition">#</a></dt>
<dd><p>This function acts as an array definition and supports different kinds of length
types.</p>
<dl>
<dt>Static (<code class="docutils literal notranslate"><span class="pre">int</span></code>)</dt><dd><p>A constant value is used to mark static arrays with a fixed length. Float
values are not accepted.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">uint8</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span>
</pre></div>
</div>
</dd>
<dt>Dynamic (<code class="xref py py-class docutils literal notranslate"><span class="pre">_ContextLambda</span></code>)</dt><dd><p>A callable function may be used to return the length as an integer. If you choose
not to use a context value, the provided callable function must take the <code class="xref py py-class docutils literal notranslate"><span class="pre">Context</span></code>
instance as its first argument.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">uint8</span><span class="p">[</span><span class="n">this</span><span class="o">.</span><span class="n">length</span><span class="p">]</span> <span class="c1"># where this.length would store 100</span>
</pre></div>
</div>
</dd>
<dt><a class="reference internal" href="datamodel.html#greedy"><span class="std std-ref">Greedy</span></a> (<code class="xref py py-class docutils literal notranslate"><span class="pre">_GreedyType</span></code>)</dt><dd><p>Used when the amount of elements to be unpacked is unknown. The struct tries to
unpack an object of the given type and stops either on EOF or if an exception
is thrown.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">uint8</span><span class="p">[</span><span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
</dd>
<dt><a class="reference internal" href="datamodel.html#prefixed"><span class="std std-ref">Prefixed</span></a> (<code class="xref py py-class docutils literal notranslate"><span class="pre">_PrefixedType</span></code>, <code class="code docutils literal notranslate"><span class="pre">slice</span></code>)</dt><dd><p>In cases where there are length-prefixed structures and you don’t want to store the
length in an extra variable, you can use <code class="xref py py-class docutils literal notranslate"><span class="pre">Prefixed</span></code> to improve packing data.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prefixed_array</span> <span class="o">=</span> <span class="n">CString</span><span class="p">[</span><span class="n">uint8</span><span class="p">::]</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is applicable to all classes annotated with <code class="code docutils literal notranslate"><span class="pre">&#64;struct</span></code> or
<code class="code docutils literal notranslate"><span class="pre">&#64;bitfield</span></code>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="struct.__rshift__">
<span class="sig-prename descclassname"><span class="pre">struct.</span></span><span class="sig-name descname"><span class="pre">__rshift__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#struct.__rshift__" title="Link to this definition">#</a></dt>
<dd><p>Invoked to apply a set of options to a <code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code>. This function changes the behavior
of a struct. It unpacks a value using the field’s underlying struct and passes it directly
into the given options to retrieve the final struct.</p>
<p>The described behavior has a limitation: if the underlying struct is not a <code class="xref py py-class docutils literal notranslate"><span class="pre">_ContextLambda</span></code>,
there is no possibility of packing an object back to binary data because the initial value is not
known.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">foo</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;bar&quot;</span><span class="p">:</span> <span class="n">uint16</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;baz&quot;</span><span class="p">:</span> <span class="n">uint32</span><span class="p">,</span>
<span class="gp">... </span><span class="p">}</span>
</pre></div>
</div>
<p>You can also include a default option using <code class="xref py py-attr docutils literal notranslate"><span class="pre">DEFAULT_OPTION</span></code> from within the
<code class="code docutils literal notranslate"><span class="pre">fields</span></code> submodule.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">foo</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;bar&quot;</span><span class="p">:</span> <span class="n">uint16</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">DEFAULT_OPTION</span><span class="p">:</span> <span class="n">ctx</span><span class="o">.</span><span class="n">_value</span>
<span class="gp">... </span><span class="p">}</span>
</pre></div>
</div>
<p>The previously parsed value is accessible from within the current context, not the
current object context.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="struct.__matmul__">
<span class="sig-prename descclassname"><span class="pre">struct.</span></span><span class="sig-name descname"><span class="pre">__matmul__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#struct.__matmul__" title="Link to this definition">#</a></dt>
<dd><p>Another special operator (<code class="code docutils literal notranslate"><span class="pre">&#64;</span></code>) is used to re-position the current field to a specified offset
position, where the offset can be static or dynamic.</p>
<p>When unpacking objects from a stream, the reader will temporarily jump to the given offset. Using the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">F_KEEP_POSITION</span></code> option, the reader will continue parsing at the resulting position.</p>
<p>Packing is tricky as we don’t want to lose any data when jumping to an offset position. Internally, a
dictionary with offset-data mappings is created and will be applied when all normal fields have been
written to the stream. Alternatively, there is an option to firstly write everything into a temporary
file and copy the final result into the given stream.</p>
<dl>
<dt>Static (<code class="code docutils literal notranslate"><span class="pre">int</span></code>)</dt><dd><p>Integer values are accepted to be static, and therefore the default behaviour is applied.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">uint8</span> <span class="o">@</span> <span class="mh">0x1234</span>
</pre></div>
</div>
</dd>
<dt>Dynamic (<code class="xref py py-class docutils literal notranslate"><span class="pre">_ContextLambda</span></code>)</dt><dd><p>Callables and context lambdas are accepted as well.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">uint8</span> <span class="o">@</span> <span class="n">this</span><span class="o">.</span><span class="n">offset</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>This operator is not applicable on raw struct classes. Therefore, the class has to be turned into
a field first. A shortcut can help you with that.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">caterpillar.shortcuts</span> <span class="kn">import</span> <span class="n">F</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">Format</span><span class="p">)</span> <span class="o">@</span> <span class="mh">0x1233</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="struct.__floordiv__">
<span class="sig-prename descclassname"><span class="pre">struct.</span></span><span class="sig-name descname"><span class="pre">__floordiv__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#struct.__floordiv__" title="Link to this definition">#</a></dt>
<dd><p><em>Experimental.</em> Invoked to link the current field or struct with a certain condition,
which can be either a static boolean value or a context lambda.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">uint8</span> <span class="o">//</span> <span class="p">(</span><span class="n">lenof</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-developer-s-note admonition">
<p class="admonition-title">Developer’s note</p>
<p>This feature is proposed to be replaced by an if-else structure chain in the future.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="struct.__rsub__">
<span class="sig-prename descclassname"><span class="pre">struct.</span></span><span class="sig-name descname"><span class="pre">__rsub__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bits</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#struct.__rsub__" title="Link to this definition">#</a></dt>
<dd><p>Invoked to specify the amount of bits this field uses. (Only applicable in classes decorated with
<code class="code docutils literal notranslate"><span class="pre">&#64;bitfield</span></code>)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">-</span> <span class="n">uint8</span>   <span class="c1"># 3 of 8 bits are used</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="struct.__and__">
<span class="sig-prename descclassname"><span class="pre">struct.</span></span><span class="sig-name descname"><span class="pre">__and__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#struct.__and__" title="Link to this definition">#</a></dt>
<dd><p>Invoked to create a chain of two structs. It is important that only the last element doesn’t need
to return a <code class="code docutils literal notranslate"><span class="pre">bytes</span></code> object after unpacking.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chain</span> <span class="o">=</span> <span class="n">ZLibCompressed</span><span class="p">(</span><span class="o">...</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">Format</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The returned object is <strong>not</strong> a <code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code> instance, but a <code class="xref py py-class docutils literal notranslate"><span class="pre">Chain</span></code> instance to
support more than two elements.</p>
</div>
</dd></dl>

</section>
<section id="field-specific-operations">
<h2><span class="section-number">3.2. </span>Field specific operations<a class="headerlink" href="#field-specific-operations" title="Link to this heading">#</a></h2>
<p>The following methods are specifically designed for fields and will only affect those. Even though these
operations are also supported on sequence objects, only the returning <code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code> object will be affected.</p>
<dl class="py function">
<dt class="sig sig-object py" id="field.__or__">
<span class="sig-prename descclassname"><span class="pre">field.</span></span><span class="sig-name descname"><span class="pre">__or__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#field.__or__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="field.__ior__">
<span class="sig-prename descclassname"><span class="pre">field.</span></span><span class="sig-name descname"><span class="pre">__ior__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#field.__ior__" title="Link to this definition">#</a></dt>
<dd><p>With the logical OR operation, a so-called <code class="xref py py-class docutils literal notranslate"><span class="pre">Flag</span></code> can be set. Some flags are defined globally, and
their meaning is described in <a class="reference internal" href="../library/options.html#options"><span class="std std-ref">Options</span></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">uint8</span> <span class="o">|</span> <span class="n">F_KEEP_POSITION</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="field.__xor__">
<span class="sig-prename descclassname"><span class="pre">field.</span></span><span class="sig-name descname"><span class="pre">__xor__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#field.__xor__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="field.__ixor__">
<span class="sig-prename descclassname"><span class="pre">field.</span></span><span class="sig-name descname"><span class="pre">__ixor__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#field.__ixor__" title="Link to this definition">#</a></dt>
<dd><p>The logical XOR operation is designed to remove a flag/option from the specified field.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">uint8</span> <span class="o">^</span> <span class="n">F_KEEP_POSITION</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="sequence-specific-operators">
<h2><span class="section-number">3.3. </span>Sequence specific operators<a class="headerlink" href="#sequence-specific-operators" title="Link to this heading">#</a></h2>
<p>The following functions have been implemented to provide a user-friendly interface for
extending <a class="reference internal" href="../library/model.html#caterpillar.model.Sequence" title="caterpillar.model.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> objects. All subclasses inherit this
functionality as well.</p>
<dl class="py function">
<dt class="sig sig-object py" id="sequence.__add__">
<span class="sig-prename descclassname"><span class="pre">sequence.</span></span><span class="sig-name descname"><span class="pre">__add__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sequence.__add__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sequence.__iadd__">
<span class="sig-prename descclassname"><span class="pre">sequence.</span></span><span class="sig-name descname"><span class="pre">__iadd__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sequence.__iadd__" title="Link to this definition">#</a></dt>
<dd><p>Called to <em>import</em> all fields from the given sequence into this instance. Note that the
fields will be added to the <em>end</em> of the current field list.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seq</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="n">uint8</span><span class="p">})</span> <span class="o">+</span> <span class="n">Sequence</span><span class="p">({</span><span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="n">uint8</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sequence.__sub__">
<span class="sig-prename descclassname"><span class="pre">sequence.</span></span><span class="sig-name descname"><span class="pre">__sub__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sequence.__sub__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sequence.__isub__">
<span class="sig-prename descclassname"><span class="pre">sequence.</span></span><span class="sig-name descname"><span class="pre">__isub__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sequence.__isub__" title="Link to this definition">#</a></dt>
<dd><p>Invoked to remove all fields in this sequence that are also stored in the given
sequence. This operation does not alter the used model but only affects the
internal model representation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seq</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="n">uint8</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="n">uint8</span><span class="p">})</span> <span class="o">-</span> <span class="n">Sequence</span><span class="p">({</span><span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="n">uint8</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="context-specific-operations">
<h2><span class="section-number">3.4. </span>Context specific operations<a class="headerlink" href="#context-specific-operations" title="Link to this heading">#</a></h2>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Context</span></code> implements attribute-like access on top of a dictionary, where the requested
path is resolved recursively. For instance, the path <code class="code docutils literal notranslate"><span class="pre">&quot;foo.bar.baz&quot;</span></code> will be split into
three parts and then <code class="code docutils literal notranslate"><span class="pre">getattr</span></code> is called until the final element has been reached or an
error occurs.</p>
<p>To enhance the facilities of a <code class="xref py py-class docutils literal notranslate"><span class="pre">Context</span></code> instance, there are special classes with even more
special operations.</p>
<section id="context-path">
<h3><span class="section-number">3.4.1. </span>Context path<a class="headerlink" href="#context-path" title="Link to this heading">#</a></h3>
<p>The context path takes a special place, as it can provide lazy execution of almost all operators
on definition. Its attribute-access model results in a new <code class="xref py py-class docutils literal notranslate"><span class="pre">ContextPath</span></code> instance.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">ContextPath</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">bar</span><span class="o">.</span><span class="n">baz</span>
<span class="go">&lt;Path &#39;foo.bar.baz&#39;&gt;</span>
</pre></div>
</div>
<p>To enable list-like access and function calls, there are special methods:</p>
<dl class="py function">
<dt class="sig sig-object py" id="path.__call__">
<span class="sig-prename descclassname"><span class="pre">path.</span></span><span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#path.__call__" title="Link to this definition">#</a></dt>
<dd><p>Calling the path without the context instance results in a special state. The path
stores the keyword arguments given in the call and executes them after retrieving
the value from the context.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span>
<span class="go">&lt;Path &#39;_obj.foo.bar&#39; call args=() kwargs={&#39;x&#39;: 19}&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="path.__getitem__">
<span class="sig-prename descclassname"><span class="pre">path.</span></span><span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#path.__getitem__" title="Link to this definition">#</a></dt>
<dd><p>This method has the same effect on the path, as it stores the key argument and executes the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__getitem__()</span></code> method on the retrieved value afterward.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">19</span><span class="p">)[</span><span class="mi">10</span><span class="p">]</span>
<span class="go">&lt;Path &#39;_obj.foo.bar&#39; call args=() kwargs={&#39;x&#39;: 19}, getitem args=10 kwargs={}&gt;</span>
</pre></div>
</div>
</dd></dl>

<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id3" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">1</a><span class="fn-bracket">]</span></span>
<p>Custom implementations must extend <code class="xref py py-class docutils literal notranslate"><span class="pre">FieldMixin</span></code> class to be able to use special operators.</p>
</aside>
</aside>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="datamodel.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Data Model</p>
      </div>
    </a>
    <a class="right-next"
       href="../library/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Library</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#struct-operators">3.1. Struct operators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#struct.__getitem__"><code class="docutils literal notranslate"><span class="pre">struct.__getitem__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#struct.__rshift__"><code class="docutils literal notranslate"><span class="pre">struct.__rshift__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#struct.__matmul__"><code class="docutils literal notranslate"><span class="pre">struct.__matmul__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#struct.__floordiv__"><code class="docutils literal notranslate"><span class="pre">struct.__floordiv__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#struct.__rsub__"><code class="docutils literal notranslate"><span class="pre">struct.__rsub__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#struct.__and__"><code class="docutils literal notranslate"><span class="pre">struct.__and__()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#field-specific-operations">3.2. Field specific operations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#field.__or__"><code class="docutils literal notranslate"><span class="pre">field.__or__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#field.__ior__"><code class="docutils literal notranslate"><span class="pre">field.__ior__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#field.__xor__"><code class="docutils literal notranslate"><span class="pre">field.__xor__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#field.__ixor__"><code class="docutils literal notranslate"><span class="pre">field.__ixor__()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sequence-specific-operators">3.3. Sequence specific operators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sequence.__add__"><code class="docutils literal notranslate"><span class="pre">sequence.__add__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sequence.__iadd__"><code class="docutils literal notranslate"><span class="pre">sequence.__iadd__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sequence.__sub__"><code class="docutils literal notranslate"><span class="pre">sequence.__sub__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sequence.__isub__"><code class="docutils literal notranslate"><span class="pre">sequence.__isub__()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#context-specific-operations">3.4. Context specific operations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#context-path">3.4.1. Context path</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#path.__call__"><code class="docutils literal notranslate"><span class="pre">path.__call__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#path.__getitem__"><code class="docutils literal notranslate"><span class="pre">path.__getitem__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/reference/operators.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023, MatrixEditor.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>